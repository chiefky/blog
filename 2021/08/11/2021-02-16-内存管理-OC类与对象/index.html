<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>red carb</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="OC中的三种对象： instance对象 class对象 meta-class对象  instance对象instance对象在内存中存储的信息  包括：  isa指针  其他成员变量 1234&#x2F;&#x2F; 实例对象：（堆区，初始化时指向它的指针在栈区）isa（前8个字节）成员变量值…  class对象class对象在内存中存储的信息 主要包括：  isa指针 superclass指针 类的属性信息（Pr">
<meta property="og:type" content="article">
<meta property="og:title" content="red carb">
<meta property="og:url" content="https://chiefky.github.io/blog/2021/08/11/2021-02-16-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86-OC%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/index.html">
<meta property="og:site_name" content="red carb">
<meta property="og:description" content="OC中的三种对象： instance对象 class对象 meta-class对象  instance对象instance对象在内存中存储的信息  包括：  isa指针  其他成员变量 1234&#x2F;&#x2F; 实例对象：（堆区，初始化时指向它的指针在栈区）isa（前8个字节）成员变量值…  class对象class对象在内存中存储的信息 主要包括：  isa指针 superclass指针 类的属性信息（Pr">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://chiefky.github.io/blog/2021/08/11/images/内存对齐_OC类与对象_NSObject.jpg">
<meta property="og:image" content="https://chiefky.github.io/blog/2021/08/11/images/内存对齐_OC类与对象_NSProxy.jpg">
<meta property="article:published_time" content="2021-08-11T07:52:05.931Z">
<meta property="article:modified_time" content="2021-08-12T04:18:45.268Z">
<meta property="article:author" content="yuli">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://chiefky.github.io/blog/2021/08/11/images/内存对齐_OC类与对象_NSObject.jpg">
  
    <link rel="alternate" href="/blog/atom.xml" title="red carb" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/blog/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">red carb</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://chiefky.github.io/blog"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-2021-02-16-内存管理-OC类与对象" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2021/08/11/2021-02-16-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86-OC%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/" class="article-date">
  <time datetime="2021-08-11T07:52:05.931Z" itemprop="datePublished">2021-08-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="OC中的三种对象："><a href="#OC中的三种对象：" class="headerlink" title="OC中的三种对象："></a>OC中的三种对象：</h2><ul>
<li>instance对象</li>
<li>class对象</li>
<li>meta-class对象</li>
</ul>
<h3 id="instance对象"><a href="#instance对象" class="headerlink" title="instance对象"></a>instance对象</h3><p>instance对象在内存中存储的信息  包括：</p>
<ul>
<li><p>isa指针</p>
</li>
<li><p>其他成员变量</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实例对象：（堆区，初始化时指向它的指针在栈区）</span></span><br><span class="line">isa（前<span class="number">8</span>个字节）</span><br><span class="line">成员变量值</span><br><span class="line">…</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="class对象"><a href="#class对象" class="headerlink" title="class对象"></a>class对象</h3><p>class对象在内存中存储的信息 主要包括：</p>
<ul>
<li>isa指针</li>
<li>superclass指针</li>
<li>类的属性信息（Property）</li>
<li>类的成员变量信息（Ivar）</li>
<li>对象方法信息（Instance Method）</li>
<li>类的协议信息（Protocol）</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 类对象：（全局区）                               </span></span><br><span class="line">isa （前<span class="number">8</span>个字节</span><br><span class="line">superClass （第二个<span class="number">8</span>个字节）</span><br><span class="line">属性信息</span><br><span class="line">成员变量信息</span><br><span class="line">对象方法信息</span><br><span class="line">协议信息</span><br><span class="line">....</span><br></pre></td></tr></table></figure>

<h3 id="meta-class对象"><a href="#meta-class对象" class="headerlink" title="meta-class对象"></a>meta-class对象</h3><p>meta-class对象在内存中存储的信息主要包括：</p>
<ul>
<li>isa指针</li>
<li>superclass指针</li>
<li>类方法信息（Class Method）</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 类对象：（全局区）                               </span><br><span class="line">isa （前8个字节</span><br><span class="line">superClass （第二个8个字节）</span><br><span class="line">类方法信息</span><br><span class="line">....</span><br></pre></td></tr></table></figure>

<h2 id="isa指向"><a href="#isa指向" class="headerlink" title="isa指向"></a>isa指向</h2><p>instance对象 —&gt; class对象 —-&gt; meta-class对象 —-&gt; NSObject(Meta) —-&gt; NSObject(Meta) 自己</p>
<p>🌰：person —&gt; YLPerson —-&gt; YLPerson(Meta) —-&gt; NSObject(Meta) —-&gt; NSObject(Meta) 自己</p>
<h2 id="super指向"><a href="#super指向" class="headerlink" title="super指向"></a>super指向</h2><p> 自定义class对象 —-&gt; NSObject —-&gt; nil</p>
<p>🌰：son —-&gt; YLPerson —-&gt; NSObject —-&gt; nil </p>
<h2 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h2><h4 id="Objective-C中的动态类型和静态类型"><a href="#Objective-C中的动态类型和静态类型" class="headerlink" title="Objective-C中的动态类型和静态类型"></a>Objective-C中的动态类型和静态类型</h4><ul>
<li><p>动态类型</p>
<p>动态类型指的是对象指针类型的动态性，具体是指使用<code>id</code>修饰后将对象的类型确定推迟到运行时，由赋给它的对象类型决定对象指针的类型。也就是说<code>id</code>修饰的对象为动态类型对象，其他在编译器指明类型的为静态类型对象，通常如果不需要涉及到多态的话还是要尽量使用静态类型（原因：错误可以在编译器提前查出，可读性好）。</p>
</li>
<li><p>静态类型</p>
<p>一个指针变量指向特定类的对象时，使用的是静态类型，在编译的时候就知道这个指针变量所属的类。使用静态类型时，编译器在编译期间，会做许多的类型检查：因为编译器需要知道哪个对象该如何使用。</p>
</li>
</ul>
<h4 id="关联返回类型和非关联返回类型"><a href="#关联返回类型和非关联返回类型" class="headerlink" title="关联返回类型和非关联返回类型"></a>关联返回类型和非关联返回类型</h4><ul>
<li><p>关联返回类型涉及的方法</p>
<ul>
<li><p>类方法：以alloc、new 开头的</p>
</li>
<li><p>实例方法：以<code>autorelease</code>，<code>init</code>，<code>retain</code>或<code>self</code>开头</p>
<p>当这些方法返回值为<code>id</code>类型时，编译器不会返回一个类型不明的对象，会返回一个方法所在类类型的对象，这些方法就被称为是关联返回类型的方法。换句话说，这些方法的返回结果以方法所在的类为类型。</p>
<p>🌰：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@interface YLAnimal : NSObject</span><br><span class="line">  </span><br><span class="line">+ (id)newTestObject;  // 返回一个自动关联为YLAnimal类型的对象</span><br><span class="line">+ (id)allocTestObject;// 返回一个自动关联为YLAnimal类型的对象</span><br><span class="line">+ (id)testObject;// 返回一个类型不明的对象</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>非关联返回类型</p>
<ul>
<li>非以上关键字开头的方法,返回值不关联所属类的类型，会返回一个类型不明的对象</li>
</ul>
</li>
</ul>
<h3 id="id、instancetype、NSObject-的区别"><a href="#id、instancetype、NSObject-的区别" class="headerlink" title="id、instancetype、NSObject * 的区别"></a>id、instancetype、NSObject * 的区别</h3><p>答：</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>使用范围</th>
<th>静态or动态</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>* 定义变量； <br />* 定义方法返回值；<br />*  定义方法参数。</td>
<td>动态类型对象；<br />编译时编译器不会检查id对象的类型，<br />只有在运行时动态检查后会报错。<br /></td>
</tr>
<tr>
<td>instancetype</td>
<td>* 只可作为函数返回值</td>
<td>动态类型 <br/>（扩大关联返回类型的方法范围，<br>不再只是cocoa定义的特定关键字开头）<br />作用：可以使那些<font color="red"><strong>非关联返回类型</strong></font>的方法返回所在类的类型</td>
</tr>
<tr>
<td>NSObject *</td>
<td>* 定义变量； <br />* 定义方法返回值；<br />*  定义方法参数。</td>
<td>静态类型<br />编译时会进行类型检查。</td>
</tr>
<tr>
<td>id<NSObject> *</td>
<td></td>
<td>只要遵循<NSObject>协议的任何一种类型；</td>
</tr>
</tbody></table>
<h3 id="Todo-关于NSProxy与NSObject"><a href="#Todo-关于NSProxy与NSObject" class="headerlink" title="Todo : 关于NSProxy与NSObject"></a>Todo : 关于NSProxy与NSObject</h3><img src="../images/内存对齐_OC类与对象_NSObject.jpg" alt="NSobject" style="zoom:80%;" />

<img src="../images/内存对齐_OC类与对象_NSProxy.jpg" style="zoom:80%;" />


      
    </div>
    <footer class="article-footer">
      <a data-url="https://chiefky.github.io/blog/2021/08/11/2021-02-16-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86-OC%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/" data-id="ckstyoocp0004xpqd1nyg39gl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/2021/08/12/2014-02-16-static-const-external%E4%BD%9C%E7%94%A8%E5%8F%8A%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/blog/2021/08/11/2021-02-16-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86-%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/ios/" rel="tag">ios</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/blog/tags/ios/" style="font-size: 10px;">ios</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/02/">February 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2021/08/27/article-title/">article title</a>
          </li>
        
          <li>
            <a href="/blog/2021/08/27/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/blog/2021/08/12/2014-02-17-GCD/">(no title)</a>
          </li>
        
          <li>
            <a href="/blog/2021/08/12/2014-02-16-static-const-external%E4%BD%9C%E7%94%A8%E5%8F%8A%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/">(no title)</a>
          </li>
        
          <li>
            <a href="/blog/2021/08/11/2021-02-16-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86-OC%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 yuli<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">Home</a>
  
    <a href="/blog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">

  
<script src="/blog/fancybox/jquery.fancybox.pack.js"></script>




<script src="/blog/js/script.js"></script>




  </div>
</body>
</html>